{"timestamp":"2025-07-21T20:21:42.174901","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-07-21T20:21:42.176093","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/etl_pipeline_v2.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-07-21T20:21:43.998369","level":"info","event":"Successfully connected to PostgreSQL database","logger":"loader"}
{"timestamp":"2025-07-21T20:21:44.014225","level":"info","event":"Rent increase analysis for rent: 346.97%","logger":"loader"}
{"timestamp":"2025-07-21T20:21:44.016429","level":"info","event":"Rent increase analysis for sale: -8.76%","logger":"loader"}
{"timestamp":"2025-07-21T20:21:44.272338","level":"info","event":"Correlation analysis completed for rent and sale","logger":"loader"}
{"timestamp":"2025-07-21T20:21:44.285166","level":"error","event":"Error in sales valuation analysis: (psycopg2.errors.UndefinedColumn) column \"listing_type\" of relation \"sales_valuation_analysis\" does not exist\nLINE 4: ...   price_per_sqm_sales, property_count, roi_rate, listing_ty...\n                                                             ^\n\n[SQL: \n                    INSERT INTO sales_valuation_analysis \n                    (city, neighborhood, property_type, avg_rent, estimated_sales_price, \n                     price_per_sqm_sales, property_count, roi_rate, listing_type)\n                    VALUES (%(city)s, %(neighborhood)s, %(property_type)s, %(avg_rent)s, %(estimated_sales_price)s,\n                            %(price_per_sqm_sales)s, %(property_count)s, %(roi_rate)s, %(listing_type)s)\n                    ]\n[parameters: {'city': 'Riyadh', 'neighborhood': 'Al Yasmeen', 'property_type': 'shop', 'avg_rent': 199956.57894736843, 'estimated_sales_price': 39991315.78947369, 'price_per_sqm_sales': 43717.67210379449, 'property_count': 38, 'roi_rate': 0.06, 'listing_type': 'rent'}]\n(Background on this error at: https://sqlalche.me/e/14/f405)","logger":"loader"}
{"timestamp":"2025-07-21T20:21:44.335241","level":"info","event":"Average price tables populated successfully","logger":"loader"}
{"timestamp":"2025-07-21T20:21:44.338531","level":"error","event":"Error populating Yasmeen 3BR report: (psycopg2.errors.UndefinedColumn) column \"neighborhood\" of relation \"yasameen_3br_report\" does not exist\nLINE 3:                 (price, neighborhood, area, bedrooms, proper...\n                                ^\n\n[SQL: \n                INSERT INTO yasameen_3br_report \n                (price, neighborhood, area, bedrooms, property_type, \n                 price_per_sqm, price_per_bedroom)\n                SELECT \n                    price,\n                    neighborhood,\n                    area,\n                    bedrooms,\n                    property_type,\n                    price_per_sqm,\n                    price_per_bedroom\n                FROM properties \n                WHERE neighborhood = 'Al Yasmeen' \n                    AND bedrooms = 3\n                    AND price > 0\n                ORDER BY price ASC\n                LIMIT 20\n                ]\n(Background on this error at: https://sqlalche.me/e/14/f405)","logger":"loader"}
{"timestamp":"2025-07-21T20:21:44.339345","level":"info","event":"Database connection closed","logger":"loader"}
{"timestamp":"2025-07-21T20:21:44.340369","level":"info","event":"Done. Returned value was: None","logger":"airflow.task.operators.airflow.providers.standard.operators.python.PythonOperator"}
{"timestamp":"2025-07-21T20:21:44.344707Z","level":"info","event":"Analysis tables populated.","chan":"stdout","logger":"task"}
