{"timestamp":"2025-07-21T18:40:32.012444","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-07-21T18:40:32.015888","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/etl_pipeline_v2.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-07-21T18:40:33.380665","level":"warning","event":"Passing literal json to 'read_json' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.","category":"FutureWarning","filename":"/opt/airflow/dags/etl_pipeline_v2.py","lineno":57,"logger":"py.warnings"}
{"timestamp":"2025-07-21T18:40:33.418334","level":"info","event":"Successfully connected to PostgreSQL database","logger":"loader"}
{"timestamp":"2025-07-21T18:40:33.424937","level":"info","event":"Missing tables: ['statistics', 'rent_increase_analysis', 'correlation_analysis', 'sales_valuation_analysis', 'avg_price_by_location', 'avg_price_by_bedroom', 'yasameen_3br_report']. Creating them now...","logger":"loader"}
{"timestamp":"2025-07-21T18:40:33.572350","level":"info","event":"Database tables created successfully","logger":"loader"}
{"timestamp":"2025-07-21T18:40:33.572720","level":"info","event":"Tables in public schema: ['properties']","logger":"loader"}
{"timestamp":"2025-07-21T18:40:33.579279","level":"info","event":"Found unique constraint(s): ['properties_property_id_key']","logger":"loader"}
{"timestamp":"2025-07-21T18:40:33.580255","level":"info","event":"Loading 3 properties to database using batch UPSERT","logger":"loader"}
{"timestamp":"2025-07-21T18:40:33.581129","level":"info","event":"Property IDs in data: 3 unique IDs","logger":"loader"}
{"timestamp":"2025-07-21T18:40:33.619993","level":"info","event":"Found 10247 existing property_ids in database","logger":"loader"}
{"timestamp":"2025-07-21T18:40:33.620920","level":"info","event":"Found 2 existing property_ids that will be updated","logger":"loader"}
{"timestamp":"2025-07-21T18:40:33.621092","level":"info","event":"Sample duplicate IDs: ['1b87659b-dc5c-4d2a-b312-c79a20de9abe', '8919c293-2380-42d1-bceb-52605c8d27e0']","logger":"loader"}
{"timestamp":"2025-07-21T18:40:33.640354","level":"info","event":"Executing batch UPSERT with 3 records","logger":"loader"}
{"timestamp":"2025-07-21T18:40:33.640616","level":"info","event":"UPSERT Query: \n            INSERT INTO properties (property_id, price, bedrooms, area, bathrooms, property_type, property_type_standard, price_per_sqm, price_per_bedroom, city, neighborhood, listing_type, source, processed_date, created_at)\n            VALUES (:property_id, :price, :bedrooms, :area, :bathrooms, :property_type, :property_type_standard, :price_per_sqm, :price_per_bedroom, :city, :neighborhood, :listing_type, :source, :processed_date, :created_at)\n            ON CONFLICT (property_id) DO UPDATE SET\n                property_id = EXCLUDED.property_id, price = EXCLUDED.price, bedrooms = EXCLUDED.bedrooms, area = EXCLUDED.area, bathrooms = EXCLUDED.bathrooms, property_type = EXCLUDED.property_type, property_type_standard = EXCLUDED.property_type_standard, price_per_sqm = EXCLUDED.price_per_sqm, price_per_bedroom = EXCLUDED.price_per_bedroom, city = EXCLUDED.city, neighborhood = EXCLUDED.neighborhood, listing_type = EXCLUDED.listing_type, source = EXCLUDED.source, processed_date = EXCLUDED.processed_date\n            ","logger":"loader"}
{"timestamp":"2025-07-21T18:40:33.648826","level":"info","event":"Batch UPSERT completed successfully","logger":"loader"}
{"timestamp":"2025-07-21T18:40:33.649167","level":"info","event":"Successfully batch upserted 3 properties to database from DataFrame","logger":"loader"}
{"timestamp":"2025-07-21T18:40:33.650504","level":"info","event":"Database connection closed","logger":"loader"}
{"timestamp":"2025-07-21T18:40:33.651413","level":"info","event":"Done. Returned value was: 3","logger":"airflow.task.operators.airflow.providers.standard.operators.python.PythonOperator"}
{"timestamp":"2025-07-21T18:40:33.651657","level":"info","event":"Pushing xcom","ti":"RuntimeTaskInstance(id=UUID('01982e48-8f59-7ee3-8e93-dca23da29afc'), task_id='load', dag_id='realestate_etl_pipeline_v2', run_id='manual__2025-07-21T18:39:23.955699+00:00', try_number=1, map_index=-1, hostname='153eb81b0c0f', context_carrier=None, task=<Task(PythonOperator): load>, bundle_instance=LocalDagBundle(name=dags-folder), max_tries=1, start_date=datetime.datetime(2025, 7, 21, 18, 40, 31, 885917, tzinfo=TzInfo(UTC)), end_date=None, is_mapped=False)","logger":"task"}
{"timestamp":"2025-07-21T18:40:33.653292Z","level":"info","event":"Loaded 3 properties into database","chan":"stdout","logger":"task"}
