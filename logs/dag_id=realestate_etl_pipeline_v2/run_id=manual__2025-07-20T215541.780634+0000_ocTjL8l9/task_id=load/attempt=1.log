{"timestamp":"2025-07-20T21:56:51.791441","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-07-20T21:56:51.792241","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/etl_pipeline_v2.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-07-20T21:56:52.974538","level":"warning","event":"Passing literal json to 'read_json' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.","category":"FutureWarning","filename":"/opt/airflow/dags/etl_pipeline_v2.py","lineno":38,"logger":"py.warnings"}
{"timestamp":"2025-07-20T21:56:53.135472Z","level":"info","event":"DEBUG: DataFrame columns before loading: ['property_id', 'title', 'price', 'bedrooms', 'area', 'bathrooms', 'property_type', 'property_type_standard', 'price_per_sqm', 'price_per_bedroom', 'city', 'neighborhood', 'listing_type', 'source', 'scraped_date', 'processed_date', 'created_at']","chan":"stdout","logger":"task"}
{"timestamp":"2025-07-20T21:56:53.149019","level":"info","event":"Successfully connected to PostgreSQL database","logger":"loader"}
{"timestamp":"2025-07-20T21:56:53.185587","level":"info","event":"Database tables created successfully","logger":"loader"}
{"timestamp":"2025-07-20T21:56:54.084942","level":"info","event":"Successfully loaded 10021 properties to database from DataFrame","logger":"loader"}
{"timestamp":"2025-07-20T21:56:54.085225","level":"info","event":"Starting comprehensive analysis...","logger":"loader"}
{"timestamp":"2025-07-20T21:56:54.091413","level":"error","event":"Error creating analysis tables: (psycopg2.errors.UndefinedColumn) column \"location\" does not exist\nLINE 4:                     location,\n                            ^\n\n[SQL: \n                CREATE OR REPLACE VIEW avg_price_by_location_view AS\n                SELECT \n                    location,\n                    neighborhood,\n                    property_type_standard,\n                    COUNT(*) as property_count,\n                    AVG(price) as avg_price,\n                    MIN(price) as min_price,\n                    MAX(price) as max_price,\n                    AVG(price_per_sqm) as avg_price_per_sqm,\n                    AVG(price_per_bedroom) as avg_price_per_bedroom\n                FROM properties \n                WHERE price > 0\n                GROUP BY location, neighborhood, property_type_standard\n                ORDER BY avg_price DESC\n                ]\n(Background on this error at: https://sqlalche.me/e/14/f405)","logger":"loader"}
{"timestamp":"2025-07-20T21:56:54.091737","level":"error","event":"Failed to create analysis tables","logger":"loader"}
{"timestamp":"2025-07-20T21:56:54.092345","level":"info","event":"Database connection closed","logger":"loader"}
{"timestamp":"2025-07-20T21:56:54.093252","level":"info","event":"Done. Returned value was: None","logger":"airflow.task.operators.airflow.providers.standard.operators.python.PythonOperator"}
