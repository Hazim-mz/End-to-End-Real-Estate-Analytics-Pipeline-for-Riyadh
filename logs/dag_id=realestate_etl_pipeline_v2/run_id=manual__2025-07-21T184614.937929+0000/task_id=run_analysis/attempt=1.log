{"timestamp":"2025-07-21T18:47:48.258984","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-07-21T18:47:48.261952","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/etl_pipeline_v2.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-07-21T18:47:50.121839","level":"info","event":"Successfully connected to PostgreSQL database","logger":"loader"}
{"timestamp":"2025-07-21T18:47:50.142920","level":"info","event":"Rent increase analysis for rent: 346.97%","logger":"loader"}
{"timestamp":"2025-07-21T18:47:50.150585","level":"info","event":"Rent increase analysis for sale: -8.76%","logger":"loader"}
{"timestamp":"2025-07-21T18:47:50.153943","level":"error","event":"Error in duration analysis: (psycopg2.errors.UndefinedColumn) column \"closed_date\" does not exist\nLINE 6:                     AVG(EXTRACT(EPOCH FROM (closed_date - cr...\n                                                    ^\n\n[SQL: \n                SELECT \n                    neighborhood,\n                    property_type_standard,\n                    listing_type,\n                    AVG(EXTRACT(EPOCH FROM (closed_date - created_at))/86400) as avg_days_to_close,\n                    COUNT(*) as property_count\n                FROM properties \n                WHERE closed_date IS NOT NULL AND created_at IS NOT NULL\n                GROUP BY neighborhood, property_type_standard, listing_type\n                ORDER BY avg_days_to_close\n                ]\n(Background on this error at: https://sqlalche.me/e/14/f405)","logger":"loader"}
{"timestamp":"2025-07-21T18:47:50.527697","level":"info","event":"Correlation analysis completed for rent and sale","logger":"loader"}
{"timestamp":"2025-07-21T18:47:50.537776","level":"error","event":"Error in sales valuation analysis: unsupported operand type(s) for /: 'decimal.Decimal' and 'float'","logger":"loader"}
{"timestamp":"2025-07-21T18:47:50.544986","level":"error","event":"Error populating average price tables: (psycopg2.errors.UndefinedColumn) column \"location\" does not exist\nLINE 6:                     location,\n                            ^\nHINT:  There is a column named \"location\" in table \"avg_price_by_location\", but it cannot be referenced from this part of the query.\n\n[SQL: \n                INSERT INTO avg_price_by_location \n                (location, neighborhood, property_type_standard, property_count, \n                 avg_price, min_price, max_price, avg_price_per_sqm, avg_price_per_bedroom)\n                SELECT \n                    location,\n                    neighborhood,\n                    property_type_standard,\n                    COUNT(*) as property_count,\n                    AVG(price) as avg_price,\n                    MIN(price) as min_price,\n                    MAX(price) as max_price,\n                    AVG(price_per_sqm) as avg_price_per_sqm,\n                    AVG(price_per_bedroom) as avg_price_per_bedroom\n                FROM properties \n                WHERE price > 0\n                GROUP BY location, neighborhood, property_type_standard\n                ORDER BY avg_price DESC\n                ]\n(Background on this error at: https://sqlalche.me/e/14/f405)","logger":"loader"}
{"timestamp":"2025-07-21T18:47:50.548353","level":"error","event":"Error populating Yasmeen 3BR report: (psycopg2.errors.UndefinedColumn) column \"location\" does not exist\nLINE 7:                     location,\n                            ^\nHINT:  There is a column named \"location\" in table \"yasameen_3br_report\", but it cannot be referenced from this part of the query.\n\n[SQL: \n                INSERT INTO yasameen_3br_report \n                (price, location, area, bedrooms, property_type, \n                 price_per_sqm, price_per_bedroom)\n                SELECT \n                    price,\n                    location,\n                    area,\n                    bedrooms,\n                    property_type,\n                    price_per_sqm,\n                    price_per_bedroom\n                FROM properties \n                WHERE neighborhood = 'Al Yasmeen' \n                    AND bedrooms = 3\n                    AND price > 0\n                ORDER BY price ASC\n                LIMIT 20\n                ]\n(Background on this error at: https://sqlalche.me/e/14/f405)","logger":"loader"}
{"timestamp":"2025-07-21T18:47:50.555425","level":"info","event":"Database connection closed","logger":"loader"}
{"timestamp":"2025-07-21T18:47:50.556676","level":"info","event":"Done. Returned value was: None","logger":"airflow.task.operators.airflow.providers.standard.operators.python.PythonOperator"}
{"timestamp":"2025-07-21T18:47:50.568874Z","level":"info","event":"Analysis tables populated.","chan":"stdout","logger":"task"}
