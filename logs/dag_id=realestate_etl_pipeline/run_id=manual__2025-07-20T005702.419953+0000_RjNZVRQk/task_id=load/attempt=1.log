{"timestamp":"2025-07-20T01:00:53.046324","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-07-20T01:00:53.047574","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/etl_pipeline.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-07-20T01:00:54.595064","level":"warning","event":"Passing literal json to 'read_json' is deprecated and will be removed in a future version. To read from a literal string, wrap it in a 'StringIO' object.","category":"FutureWarning","filename":"/opt/airflow/dags/etl_pipeline.py","lineno":40,"logger":"py.warnings"}
{"timestamp":"2025-07-20T01:00:54.729841","level":"info","event":"Successfully connected to PostgreSQL database","logger":"loader"}
{"timestamp":"2025-07-20T01:00:54.842818","level":"error","event":"Error creating tables: 'Connection' object has no attribute 'commit'","logger":"loader"}
{"timestamp":"2025-07-20T01:00:55.347103","level":"error","event":"Error loading properties data from DataFrame: (psycopg2.errors.NumericValueOutOfRange) numeric field overflow\nDETAIL:  A field with precision 12, scale 2 must round to an absolute value less than 10^10.\n\n[SQL: INSERT INTO properties (title, price, location, bedrooms, area, property_type, property_type_standard, price_per_sqm, price_per_bedroom, neighborhood, source, scraped_date, processed_date, created_at) VALUES (%(title)s, %(price)s, %(location)s, %(bedrooms)s, %(area)s, %(property_type)s, %(property_type_standard)s, %(price_per_sqm)s, %(price_per_bedroom)s, %(neighborhood)s, %(source)s, %(scraped_date)s, %(processed_date)s, %(created_at)s)]\n[parameters: ({'title': None, 'price': 1320000, 'location': 'الملقا, Riyadh', 'bedrooms': 0, 'area': None, 'property_type': 'أرض', 'property_type_standard': None, 'price_per_sqm': None, 'price_per_bedroom': None, 'neighborhood': 'Al Malga', 'source': 'historical', 'scraped_date': None, 'processed_date': None, 'created_at': None}, {'title': None, 'price': 1800000, 'location': 'الملقا, Riyadh', 'bedrooms': 0, 'area': None, 'property_type': 'أرض', 'property_type_standard': None, 'price_per_sqm': None, 'price_per_bedroom': None, 'neighborhood': 'Al Malga', 'source': 'historical', 'scraped_date': None, 'processed_date': None, 'created_at': None}, {'title': None, 'price': 24000, 'location': 'الملقا, Riyadh', 'bedrooms': 2, 'area': None, 'property_type': 'شقة', 'property_type_standard': None, 'price_per_sqm': None, 'price_per_bedroom': None, 'neighborhood': 'Al Malga', 'source': 'historical', 'scraped_date': None, 'processed_date': None, 'created_at': None}, {'title': None, 'price': 45000, 'location': 'الياسمين, Riyadh', 'bedrooms': 5, 'area': None, 'property_type': 'دور', 'property_type_standard': None, 'price_per_sqm': None, 'price_per_bedroom': None, 'neighborhood': 'Al Yasmeen', 'source': 'historical', 'scraped_date': None, 'processed_date': None, 'created_at': None}, {'title': None, 'price': 600000, 'location': 'الياسمين, Riyadh', 'bedrooms': 4, 'area': None, 'property_type': 'شقة', 'property_type_standard': None, 'price_per_sqm': None, 'price_per_bedroom': None, 'neighborhood': 'Al Yasmeen', 'source': 'historical', 'scraped_date': None, 'processed_date': None, 'created_at': None}, {'title': None, 'price': 7500000, 'location': 'الملقا, Riyadh', 'bedrooms': 5, 'area': None, 'property_type': 'فيلا', 'property_type_standard': None, 'price_per_sqm': None, 'price_per_bedroom': None, 'neighborhood': 'Al Malga', 'source': 'historical', 'scraped_date': None, 'processed_date': None, 'created_at': None}, {'title': None, 'price': 1218000, 'location': 'الملقا, Riyadh', 'bedrooms': 0, 'area': None, 'property_type': 'أرض', 'property_type_standard': None, 'price_per_sqm': None, 'price_per_bedroom': None, 'neighborhood': 'Al Malga', 'source': 'historical', 'scraped_date': None, 'processed_date': None, 'created_at': None}, {'title': None, 'price': 21000, 'location': 'الملقا, Riyadh', 'bedrooms': 2, 'area': None, 'property_type': 'شقة', 'property_type_standard': None, 'price_per_sqm': None, 'price_per_bedroom': None, 'neighborhood': 'Al Malga', 'source': 'historical', 'scraped_date': None, 'processed_date': None, 'created_at': None}  ... displaying 10 of 10047 total bound parameter sets ...  {'title': 'ارض للبيع', 'price': 10800000, 'location': 'الملقا, الرياض, Riyadh', 'bedrooms': 0, 'area': 900.0, 'property_type': 'apartment', 'property_type_standard': 'apartment', 'price_per_sqm': 12000.0, 'price_per_bedroom': None, 'neighborhood': 'Al Malga', 'source': 'scraped', 'scraped_date': datetime.datetime(1970, 1, 1, 0, 0, 1, 752973), 'processed_date': None, 'created_at': None}, {'title': 'دور للإيجار', 'price': 100000, 'location': 'الملقا, الرياض, Riyadh', 'bedrooms': 4, 'area': 300.0, 'property_type': 'floor', 'property_type_standard': 'floor', 'price_per_sqm': 333.3333333333, 'price_per_bedroom': 25000.0, 'neighborhood': 'Al Malga', 'source': 'scraped', 'scraped_date': datetime.datetime(1970, 1, 1, 0, 0, 1, 752973), 'processed_date': None, 'created_at': None})]\n(Background on this error at: https://sqlalche.me/e/14/9h9h)","logger":"loader"}
{"timestamp":"2025-07-20T01:00:55.347421","level":"info","event":"Starting comprehensive analysis...","logger":"loader"}
{"timestamp":"2025-07-20T01:00:55.352713","level":"error","event":"Error creating analysis tables: (psycopg2.errors.WrongObjectType) \"avg_price_by_location\" is not a view\n\n[SQL: \n                CREATE OR REPLACE VIEW avg_price_by_location AS\n                SELECT \n                    location,\n                    neighborhood,\n                    property_type_standard,\n                    COUNT(*) as property_count,\n                    AVG(price) as avg_price,\n                    MIN(price) as min_price,\n                    MAX(price) as max_price,\n                    AVG(price_per_sqm) as avg_price_per_sqm,\n                    AVG(price_per_bedroom) as avg_price_per_bedroom\n                FROM properties \n                WHERE price > 0\n                GROUP BY location, neighborhood, property_type_standard\n                ORDER BY avg_price DESC\n                ]\n(Background on this error at: https://sqlalche.me/e/14/f405)","logger":"loader"}
{"timestamp":"2025-07-20T01:00:55.353241","level":"error","event":"Failed to create analysis tables","logger":"loader"}
{"timestamp":"2025-07-20T01:00:55.354033","level":"info","event":"Database connection closed","logger":"loader"}
{"timestamp":"2025-07-20T01:00:55.354914","level":"info","event":"Done. Returned value was: None","logger":"airflow.task.operators.airflow.providers.standard.operators.python.PythonOperator"}
