{"timestamp":"2025-07-20T22:44:59.209678","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-07-20T22:44:59.210839","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/load_historical_data.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-07-20T22:44:59.989909","level":"info","event":"Loading only the historical data file...","logger":"transformer"}
{"timestamp":"2025-07-20T22:45:01.161793","level":"info","event":"Loaded 99969 records from data/raw/realstate_data_2014_2016.csv (utf-8)","logger":"transformer"}
{"timestamp":"2025-07-20T22:45:01.163763","level":"info","event":"Total raw records loaded: 99969","logger":"transformer"}
{"timestamp":"2025-07-20T22:45:01.630239","level":"info","event":"Warehouse data saved to data/warehouse/riyadh_yasmeen_malga.csv","logger":"transformer"}
{"timestamp":"2025-07-20T22:45:01.630524","level":"info","event":"Data quality report saved to data/warehouse/quality_report.json","logger":"transformer"}
{"timestamp":"2025-07-20T22:45:01.641040","level":"info","event":"Successfully connected to PostgreSQL database","logger":"loader"}
{"timestamp":"2025-07-20T22:45:01.667847","level":"info","event":"Database tables created successfully","logger":"loader"}
{"timestamp":"2025-07-20T22:45:01.691831","level":"error","event":"Error loading properties data from DataFrame: (psycopg2.errors.UndefinedFunction) operator does not exist: character varying = integer\nLINE 1: ...ECT property_id FROM properties WHERE property_id = ANY(ARRA...\n                                                             ^\nHINT:  No operator matches the given name and argument types. You might need to add explicit type casts.\n\n[SQL: SELECT property_id FROM properties WHERE property_id = ANY(%(ids)s)]\n[parameters: {'ids': [117248, 72027, 126752, 80556, 72580, 39973, 123653, 84993, 143285, 107100, 71500, 124056, 95544, 30791, 151886, 2801, 12048, 142271, 38151, 85562, 10 ... (73110 characters truncated) ... 57, 116112, 47167, 155620, 104515, 111116, 116465, 121911, 141094, 18703, 42125, 39556, 99739, 1043, 88866, 119012, 14289, 117465, 9780, 29964, 34620]}]\n(Background on this error at: https://sqlalche.me/e/14/f405)","logger":"loader"}
{"timestamp":"2025-07-20T22:45:01.692596","level":"info","event":"Database connection closed","logger":"loader"}
{"timestamp":"2025-07-20T22:45:01.692866","level":"error","event":"Task failed with exception","logger":"task","error_detail":[{"exc_type":"Exception","exc_value":"Failed to load historical data into database","exc_notes":[],"syntax_error":null,"is_cause":false,"frames":[{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":825,"name":"run"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":1088,"name":"_execute_task"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/bases/operator.py","lineno":408,"name":"wrapper"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/standard/operators/python.py","lineno":212,"name":"execute"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/standard/operators/python.py","lineno":235,"name":"execute_callable"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/callback_runner.py","lineno":81,"name":"run"},{"filename":"/opt/airflow/dags/load_historical_data.py","lineno":34,"name":"load_historical_data_task"}]}]}
