{"timestamp":"2025-07-21T02:11:41.088974","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-07-21T02:11:41.089657","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/load_historical_data.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-07-21T02:11:41.944774","level":"info","event":"Loading only the historical data file...","logger":"transformer"}
{"timestamp":"2025-07-21T02:11:43.241329","level":"info","event":"Loaded 99969 records from data/raw/realstate_data_2014_2016.csv (utf-8)","logger":"transformer"}
{"timestamp":"2025-07-21T02:11:43.245248","level":"info","event":"Total raw records loaded: 99969","logger":"transformer"}
{"timestamp":"2025-07-21T02:11:43.932057","level":"info","event":"Price per sqm - Min: 0.05272727272727273, Max: 100000.0, Mean: 4581.303909547972","logger":"transformer"}
{"timestamp":"2025-07-21T02:11:43.932586","level":"info","event":"Price per bedroom - Min: 11.0, Max: 1000000.0, Mean: 336141.05722317763","logger":"transformer"}
{"timestamp":"2025-07-21T02:11:44.074403","level":"info","event":"Warehouse data saved to data/warehouse/riyadh_yasmeen_malga.csv","logger":"transformer"}
{"timestamp":"2025-07-21T02:11:44.074581","level":"info","event":"Data quality report saved to data/warehouse/quality_report.json","logger":"transformer"}
{"timestamp":"2025-07-21T02:11:44.088625","level":"info","event":"Successfully connected to PostgreSQL database","logger":"loader"}
{"timestamp":"2025-07-21T02:11:44.091213","level":"info","event":"Tables already exist, skipping creation","logger":"loader"}
{"timestamp":"2025-07-21T02:11:44.091747","level":"info","event":"Loading 10021 properties to database using batch UPSERT","logger":"loader"}
{"timestamp":"2025-07-21T02:11:44.093638","level":"info","event":"Property IDs in data: 10021 unique IDs","logger":"loader"}
{"timestamp":"2025-07-21T02:11:44.116959","level":"info","event":"Found 10029 existing property_ids in database","logger":"loader"}
{"timestamp":"2025-07-21T02:11:44.120117","level":"info","event":"Found 10021 existing property_ids that will be updated","logger":"loader"}
{"timestamp":"2025-07-21T02:11:44.120497","level":"info","event":"Sample duplicate IDs: ['93007', '12252', '107384', '138649', '92429']","logger":"loader"}
{"timestamp":"2025-07-21T02:11:45.230729","level":"info","event":"Executing batch UPSERT with 10021 records","logger":"loader"}
{"timestamp":"2025-07-21T02:11:45.230934","level":"info","event":"UPSERT Query: \n            INSERT INTO properties (property_id, title, price, bedrooms, area, bathrooms, property_type, property_type_standard, price_per_sqm, price_per_bedroom, city, neighborhood, listing_type, source, scraped_date, processed_date, created_at)\n            VALUES (:property_id, :title, :price, :bedrooms, :area, :bathrooms, :property_type, :property_type_standard, :price_per_sqm, :price_per_bedroom, :city, :neighborhood, :listing_type, :source, :scraped_date, :processed_date, :created_at)\n            ON CONFLICT (property_id) DO UPDATE SET\n                property_id = EXCLUDED.property_id, title = EXCLUDED.title, price = EXCLUDED.price, bedrooms = EXCLUDED.bedrooms, area = EXCLUDED.area, bathrooms = EXCLUDED.bathrooms, property_type = EXCLUDED.property_type, property_type_standard = EXCLUDED.property_type_standard, price_per_sqm = EXCLUDED.price_per_sqm, price_per_bedroom = EXCLUDED.price_per_bedroom, city = EXCLUDED.city, neighborhood = EXCLUDED.neighborhood, listing_type = EXCLUDED.listing_type, source = EXCLUDED.source, scraped_date = EXCLUDED.scraped_date, processed_date = EXCLUDED.processed_date\n            ","logger":"loader"}
{"timestamp":"2025-07-21T02:11:49.814914","level":"info","event":"Batch UPSERT completed successfully","logger":"loader"}
{"timestamp":"2025-07-21T02:11:49.815287","level":"info","event":"Successfully batch upserted 10021 properties to database from DataFrame","logger":"loader"}
{"timestamp":"2025-07-21T02:11:49.833277","level":"info","event":"Database connection closed","logger":"loader"}
{"timestamp":"2025-07-21T02:11:49.848312","level":"info","event":"Done. Returned value was: 10021","logger":"airflow.task.operators.airflow.providers.standard.operators.python.PythonOperator"}
{"timestamp":"2025-07-21T02:11:49.848763","level":"info","event":"Pushing xcom","ti":"RuntimeTaskInstance(id=UUID('01982ac0-4397-799f-8c78-7e1a605c620f'), task_id='load_historical', dag_id='load_historical_data', run_id='manual__2025-07-21T02:11:40.039979+00:00', try_number=1, map_index=-1, hostname='d9baf7fb2a61', context_carrier=None, task=<Task(PythonOperator): load_historical>, bundle_instance=LocalDagBundle(name=dags-folder), max_tries=1, start_date=datetime.datetime(2025, 7, 21, 2, 11, 41, 21815, tzinfo=TzInfo(UTC)), end_date=None, is_mapped=False)","logger":"task"}
{"timestamp":"2025-07-21T02:11:49.890182Z","level":"info","event":"Loaded 10021 historical records","chan":"stdout","logger":"task"}
